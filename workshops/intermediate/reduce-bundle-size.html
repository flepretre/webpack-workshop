<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Bundle size hunting ‚úÇÔ∏è | Webpack Workshop</title>
    <meta name="description" content="Webpack discovering and mastering workshops">
    
    
    <link rel="preload" href="/webpack-workshop/assets/css/0.styles.446b2bb4.css" as="style"><link rel="preload" href="/webpack-workshop/assets/js/app.b974cde2.js" as="script"><link rel="preload" href="/webpack-workshop/assets/js/11.242fe18c.js" as="script"><link rel="prefetch" href="/webpack-workshop/assets/js/10.5b9bcf6c.js"><link rel="prefetch" href="/webpack-workshop/assets/js/12.c7f9bfc0.js"><link rel="prefetch" href="/webpack-workshop/assets/js/13.1e91b35f.js"><link rel="prefetch" href="/webpack-workshop/assets/js/14.460876df.js"><link rel="prefetch" href="/webpack-workshop/assets/js/15.3718f7bb.js"><link rel="prefetch" href="/webpack-workshop/assets/js/16.58b2cd73.js"><link rel="prefetch" href="/webpack-workshop/assets/js/17.35dc59c3.js"><link rel="prefetch" href="/webpack-workshop/assets/js/18.6b059783.js"><link rel="prefetch" href="/webpack-workshop/assets/js/3.1997f929.js"><link rel="prefetch" href="/webpack-workshop/assets/js/4.91958876.js"><link rel="prefetch" href="/webpack-workshop/assets/js/5.f69e1dd5.js"><link rel="prefetch" href="/webpack-workshop/assets/js/6.8a9b0e5a.js"><link rel="prefetch" href="/webpack-workshop/assets/js/7.8abd1560.js"><link rel="prefetch" href="/webpack-workshop/assets/js/8.7bae7cd8.js"><link rel="prefetch" href="/webpack-workshop/assets/js/9.4f8d457a.js"><link rel="prefetch" href="/webpack-workshop/assets/js/vendors~docsearch.d932dc62.js">
    <link rel="stylesheet" href="/webpack-workshop/assets/css/0.styles.446b2bb4.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/webpack-workshop/" class="home-link router-link-active"><!----> <span class="site-name">Webpack Workshop</span></a> <div class="links" style="max-width:nullpx;"><form id="search-form" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/webpack-workshop/" class="nav-link">Home</a></div><div class="nav-item"><a href="/webpack-workshop/workshops/" class="nav-link router-link-active">Workshops</a></div> <a href="https://github.com/Slashgear/webpack-workshop" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/webpack-workshop/" class="nav-link">Home</a></div><div class="nav-item"><a href="/webpack-workshop/workshops/" class="nav-link router-link-active">Workshops</a></div> <a href="https://github.com/Slashgear/webpack-workshop" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/webpack-workshop/workshops/" class="sidebar-link">Get started</a></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Novice</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/webpack-workshop/workshops/novice/basics.html" class="sidebar-link">Basics</a></li><li><a href="/webpack-workshop/workshops/novice/static-assets.html" class="sidebar-link">Handling static assets</a></li><li><a href="/webpack-workshop/workshops/novice/code-assets.html" class="sidebar-link">Handling üíÖ assets</a></li><li><a href="/webpack-workshop/workshops/novice/outputs.html" class="sidebar-link">Playing with outputs</a></li><li><a href="/webpack-workshop/workshops/novice/novice-koans.html" class="sidebar-link">Novice Ko√¢ns üìå</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading open"><span>Intermediate</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/webpack-workshop/workshops/intermediate/dev.html" class="sidebar-link">Development Tricks üöÄ</a></li><li><a href="/webpack-workshop/workshops/intermediate/babel.html" class="sidebar-link">Use Babel</a></li><li><a href="/webpack-workshop/workshops/intermediate/style.html" class="sidebar-link">Coding with style üíÖ</a></li><li><a href="/webpack-workshop/workshops/intermediate/reduce-bundle-size.html" class="active sidebar-link">Bundle size hunting ‚úÇÔ∏è</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/webpack-workshop/workshops/intermediate/reduce-bundle-size.html#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/webpack-workshop/workshops/intermediate/reduce-bundle-size.html#example-app" class="sidebar-link">Example App</a></li><li class="sidebar-sub-header"><a href="/webpack-workshop/workshops/intermediate/reduce-bundle-size.html#analysing-bundle-size-and-content" class="sidebar-link">Analysing bundle size and content</a></li><li class="sidebar-sub-header"><a href="/webpack-workshop/workshops/intermediate/reduce-bundle-size.html#tree-shaking-your-code" class="sidebar-link">Tree shaking your code</a></li><li class="sidebar-sub-header"><a href="/webpack-workshop/workshops/intermediate/reduce-bundle-size.html#code-splitting" class="sidebar-link">Code splitting</a></li><li class="sidebar-sub-header"><a href="/webpack-workshop/workshops/intermediate/reduce-bundle-size.html#name-your-chunks" class="sidebar-link">Name your chunks !</a></li><li class="sidebar-sub-header"><a href="/webpack-workshop/workshops/intermediate/reduce-bundle-size.html#prefetch-your-bundles" class="sidebar-link">Prefetch your bundles !</a></li></ul></li><li><a href="/webpack-workshop/workshops/intermediate/intermediate-koans.html" class="sidebar-link">Intermediate Ko√¢ns üìå</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="bundle-size-hunting"><a href="#bundle-size-hunting" aria-hidden="true" class="header-anchor">#</a> Bundle size hunting ‚úÇÔ∏è</h1> <blockquote><p>To start this exercise, be sure to be in <code>./packages/intermediate/reduce-bundle-size</code> folder.
Be sure you have <a href="/webpack-workshop/workshops/#install">installed this repository first</a></p></blockquote> <h2 id="introduction"><a href="#introduction" aria-hidden="true" class="header-anchor">#</a> Introduction</h2> <p>Having a tool like webpack to generate code &quot;bundles&quot; is great to let it handle code dependencies.
However it would be quite difficult to keep those generate bundle under a critic size.</p> <p>Main causes are:</p> <ul><li>Your app contains a huge quantity of code</li> <li>You import huge dependencies</li> <li>You are generating too few bundles. Your browser need to load and parse a huge file before rendering your all app.</li></ul> <h2 id="example-app"><a href="#example-app" aria-hidden="true" class="header-anchor">#</a> Example App</h2> <p>This is a really simple pokedex app made with vuejs.
In order to simplify build configuration, we won't use <code>vue-loader</code> here.
The app have two pages :</p> <ul><li>home page displaying 20 pokemons</li> <li>pokemon detail page with a specific image.</li></ul> <p>You can start this application with:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>yarn start
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>When you start your server, you will notice webpack warnings in the console.
Webpack is trying to tell you that your app bundle is too fat.</p> <p>Let's try to fix that ! üòâ</p></div> <h2 id="analysing-bundle-size-and-content"><a href="#analysing-bundle-size-and-content" aria-hidden="true" class="header-anchor">#</a> Analysing bundle size and content</h2> <p>First thing first, let's try to focus on what is in our bundle and you it is too fat.</p> <p>We will use <a href="https://github.com/webpack-contrib/webpack-bundle-analyzer" target="_blank" rel="noopener noreferrer">Webpack Bundle Analyser<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <details><summary>Solution</summary> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> BundleAnalyzerPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;webpack-bundle-analyzer&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span>BundleAnalyzerPlugin<span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">BundleAnalyzerPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></details> <p>You should normally see a lonely bundle containing:</p> <ul><li>all bulma code</li> <li>all lodash lib</li> <li>vue js</li> <li>all your app code</li></ul> <h2 id="tree-shaking-your-code"><a href="#tree-shaking-your-code" aria-hidden="true" class="header-anchor">#</a> Tree shaking your code</h2> <p>Let's try to cut tree by the big branches first: the dependencies.</p> <p>We are importing all bulma code, let's try to reduce bundle size by importing only whta is needed:</p> <ul><li>columns</li> <li>headings</li> <li>card</li></ul> <details><summary>Solution</summary> <p>Create a file <code>app.sass</code> and only load bulma parts.</p> <div class="language-sass extra-class"><pre class="language-sass"><code><span class="token atrule-line"><span class="token atrule">@charset</span> &quot;utf-8&quot;;</span>

<span class="token atrule-line"><span class="token atrule">@import</span> &quot;~bulma/sass/utilities/_all.sass&quot;</span>
<span class="token atrule-line"><span class="token atrule">@import</span> &quot;~bulma/sass/base/_all.sass&quot;</span>
<span class="token atrule-line"><span class="token atrule">@import</span> &quot;~bulma/sass/components/card.sass&quot;</span>
<span class="token atrule-line"><span class="token atrule">@import</span> &quot;~bulma/sass/elements/title.sass&quot;</span>
<span class="token atrule-line"><span class="token atrule">@import</span> &quot;~bulma/sass/grid/columns.sass&quot;</span>
</code></pre></div></details> <p>Let's try to load just one function of lodash instead of all the lib</p> <details><summary>Solution</summary> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> _capitalize <span class="token keyword">from</span> <span class="token string">&quot;lodash/capitalize&quot;</span><span class="token punctuation">;</span>
</code></pre></div></details> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>For lodash you could also use <a href="https://github.com/lodash/babel-plugin-lodash" target="_blank" rel="noopener noreferrer">babel plugin lodash<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> if your are using babel in your app.</p></div> <p>We only cut the trees we don't grew directly, this was our dependencies.
Let's focus on app code, if you look at <code>pokemon.service.js</code> you will see that a method is not use in our application.
Webpack can detect it and removes it from the bundle.</p> <div class="warning custom-block"><p class="custom-block-title">WARNING</p> <p>Webpack is not automagically tree shaking dead code. üò≠</p></div> <p>To do so, we have to tell Webpack:</p> <blockquote><p>&quot;ok my code is safe, it does not contain modules creating side effects on the app you could try to optimize it&quot; - You</p></blockquote> <p>Just try to add <code>&quot;sideEffects&quot;: false</code> in your package.json file.
Webpack will load this configuration and will optimize bundles to eliminate dead code.</p> <p>Your app should be broken by now, all the CSS should be missing.
CSS module are by nature creating side-effects.</p> <p>Let's try with <code>&quot;sideEffects&quot;: [&quot;*.sass&quot;]</code> üéâ!</p> <p>You can verify, no lodash in your bundle at all !</p> <h2 id="code-splitting"><a href="#code-splitting" aria-hidden="true" class="header-anchor">#</a> Code splitting</h2> <p>Now the app is loading only the dependencies we need.
Let's try to load only home page code on home page ! üòÑ</p> <p>To do so we will need to generate two bundles: one for home, and one for details page.</p> <p>We could do that by adding another entry in Webpack configuration <strong>OR</strong> we could use webpack dynamic imports.</p> <p>VueJS is ok by default with async component üéâ , let's try to import our page in router with dynamic import.</p> <p>It will generate 1 bundle for each page.</p> <details><summary>Solution</summary> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Router <span class="token keyword">from</span> <span class="token string">&quot;vue-router&quot;</span><span class="token punctuation">;</span>

Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Router<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">Router</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  routes<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> path<span class="token punctuation">:</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> component<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&quot;./pages/home&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      path<span class="token punctuation">:</span> <span class="token string">&quot;/details/:id&quot;</span><span class="token punctuation">,</span>
      component<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&quot;./pages/details&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      props<span class="token punctuation">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></details> <h2 id="name-your-chunks"><a href="#name-your-chunks" aria-hidden="true" class="header-anchor">#</a> Name your chunks !</h2> <p>Ok the two <code>chunk</code> contains your page code and that's great.
You could try to load your app, the browser will only load the JS you need to display the page.</p> <p>Maybe we could name those chunk to help us understand what we just split.</p> <ol><li>Change the output filename config to <code>[name].bundle.js</code></li> <li>Add a comment in the dynamic import to name your chunk (<code>import(/* webpackChunkName: &quot;home&quot; */ &quot;./pages/home&quot;)</code>)</li></ol> <h2 id="prefetch-your-bundles"><a href="#prefetch-your-bundles" aria-hidden="true" class="header-anchor">#</a> Prefetch your bundles !</h2> <p>You can also tell your browser, ok you don't need that bundle for now, but try to prefetch it if you have time, it is good for you.
This could be done with another webpack comment, look at <a href="https://webpack.js.org/guides/code-splitting/#prefetchingpreloading-modules" target="_blank" rel="noopener noreferrer">related doc<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/Slashgear/webpack-workshop/edit/master/docs/workshops/intermediate/reduce-bundle-size.md" target="_blank" rel="noopener noreferrer">Help us improve this page!</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">2/12/2019, 10:45:15 PM</span></div></div> <div class="page-nav"><p class="inner"><span class="prev">
        ‚Üê
        <a href="/webpack-workshop/workshops/intermediate/style.html" class="prev">
          Coding with style üíÖ
        </a></span> <span class="next"><a href="/webpack-workshop/workshops/intermediate/intermediate-koans.html">
          Intermediate Ko√¢ns üìå
        </a>
        ‚Üí
      </span></p></div> </div> <!----></div></div>
    <script src="/webpack-workshop/assets/js/app.b974cde2.js" defer></script><script src="/webpack-workshop/assets/js/11.242fe18c.js" defer></script>
  </body>
</html>
