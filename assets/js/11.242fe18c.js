(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{178:function(t,e,s){"use strict";s.r(e);var a=s(0),n=Object(a.a)({},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"content"},[t._m(0),t._v(" "),s("blockquote",[s("p",[t._v("To start this exercise, be sure to be in "),s("code",[t._v("./packages/intermediate/reduce-bundle-size")]),t._v(" folder.\nBe sure you have "),s("router-link",{attrs:{to:"./../#install"}},[t._v("installed this repository first")])],1)]),t._v(" "),t._m(1),t._v(" "),s("p",[t._v('Having a tool like webpack to generate code "bundles" is great to let it handle code dependencies.\nHowever it would be quite difficult to keep those generate bundle under a critic size.')]),t._v(" "),s("p",[t._v("Main causes are:")]),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),t._m(4),t._v(" "),t._m(5),t._v(" "),s("p",[t._v("You can start this application with:")]),t._v(" "),t._m(6),t._m(7),t._v(" "),t._m(8),t._v(" "),s("p",[t._v("First thing first, let's try to focus on what is in our bundle and you it is too fat.")]),t._v(" "),s("p",[t._v("We will use "),s("a",{attrs:{href:"https://github.com/webpack-contrib/webpack-bundle-analyzer",target:"_blank",rel:"noopener noreferrer"}},[t._v("Webpack Bundle Analyser"),s("OutboundLink")],1)]),t._v(" "),t._m(9),t._v(" "),s("p",[t._v("You should normally see a lonely bundle containing:")]),t._v(" "),t._m(10),t._v(" "),t._m(11),t._v(" "),s("p",[t._v("Let's try to cut tree by the big branches first: the dependencies.")]),t._v(" "),s("p",[t._v("We are importing all bulma code, let's try to reduce bundle size by importing only whta is needed:")]),t._v(" "),t._m(12),t._v(" "),t._m(13),t._v(" "),s("p",[t._v("Let's try to load just one function of lodash instead of all the lib")]),t._v(" "),t._m(14),t._v(" "),s("div",{staticClass:"tip custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),s("p",[t._v("For lodash you could also use "),s("a",{attrs:{href:"https://github.com/lodash/babel-plugin-lodash",target:"_blank",rel:"noopener noreferrer"}},[t._v("babel plugin lodash"),s("OutboundLink")],1),t._v(" if your are using babel in your app.")])]),t._v(" "),t._m(15),t._v(" "),t._m(16),t._v(" "),s("p",[t._v("To do so, we have to tell Webpack:")]),t._v(" "),t._m(17),t._v(" "),t._m(18),t._v(" "),s("p",[t._v("Your app should be broken by now, all the CSS should be missing.\nCSS module are by nature creating side-effects.")]),t._v(" "),t._m(19),t._v(" "),s("p",[t._v("You can verify, no lodash in your bundle at all !")]),t._v(" "),t._m(20),t._v(" "),s("p",[t._v("Now the app is loading only the dependencies we need.\nLet's try to load only home page code on home page ! ðŸ˜„")]),t._v(" "),s("p",[t._v("To do so we will need to generate two bundles: one for home, and one for details page.")]),t._v(" "),t._m(21),t._v(" "),s("p",[t._v("VueJS is ok by default with async component ðŸŽ‰ , let's try to import our page in router with dynamic import.")]),t._v(" "),s("p",[t._v("It will generate 1 bundle for each page.")]),t._v(" "),t._m(22),t._v(" "),t._m(23),t._v(" "),t._m(24),t._v(" "),s("p",[t._v("Maybe we could name those chunk to help us understand what we just split.")]),t._v(" "),t._m(25),t._v(" "),t._m(26),t._v(" "),s("p",[t._v("You can also tell your browser, ok you don't need that bundle for now, but try to prefetch it if you have time, it is good for you.\nThis could be done with another webpack comment, look at "),s("a",{attrs:{href:"https://webpack.js.org/guides/code-splitting/#prefetchingpreloading-modules",target:"_blank",rel:"noopener noreferrer"}},[t._v("related doc"),s("OutboundLink")],1)])])},[function(){var t=this.$createElement,e=this._self._c||t;return e("h1",{attrs:{id:"bundle-size-hunting"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#bundle-size-hunting","aria-hidden":"true"}},[this._v("#")]),this._v(" Bundle size hunting âœ‚ï¸")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"introduction"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#introduction","aria-hidden":"true"}},[this._v("#")]),this._v(" Introduction")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("Your app contains a huge quantity of code")]),this._v(" "),e("li",[this._v("You import huge dependencies")]),this._v(" "),e("li",[this._v("You are generating too few bundles. Your browser need to load and parse a huge file before rendering your all app.")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"example-app"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#example-app","aria-hidden":"true"}},[this._v("#")]),this._v(" Example App")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("This is a really simple pokedex app made with vuejs.\nIn order to simplify build configuration, we won't use "),e("code",[this._v("vue-loader")]),this._v(" here.\nThe app have two pages :")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("home page displaying 20 pokemons")]),this._v(" "),e("li",[this._v("pokemon detail page with a specific image.")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[this._v("yarn start\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"tip custom-block"},[e("p",{staticClass:"custom-block-title"},[this._v("TIP")]),this._v(" "),e("p",[this._v("When you start your server, you will notice webpack warnings in the console.\nWebpack is trying to tell you that your app bundle is too fat.")]),this._v(" "),e("p",[this._v("Let's try to fix that ! ðŸ˜‰")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"analysing-bundle-size-and-content"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#analysing-bundle-size-and-content","aria-hidden":"true"}},[this._v("#")]),this._v(" Analysing bundle size and content")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("details",[s("summary",[t._v("Solution")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" BundleAnalyzerPlugin "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"webpack-bundle-analyzer"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("BundleAnalyzerPlugin"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nmodule"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  plugins"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BundleAnalyzerPlugin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("all bulma code")]),this._v(" "),e("li",[this._v("all lodash lib")]),this._v(" "),e("li",[this._v("vue js")]),this._v(" "),e("li",[this._v("all your app code")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"tree-shaking-your-code"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#tree-shaking-your-code","aria-hidden":"true"}},[this._v("#")]),this._v(" Tree shaking your code")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("columns")]),this._v(" "),e("li",[this._v("headings")]),this._v(" "),e("li",[this._v("card")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("details",[s("summary",[t._v("Solution")]),t._v(" "),s("p",[t._v("Create a file "),s("code",[t._v("app.sass")]),t._v(" and only load bulma parts.")]),t._v(" "),s("div",{staticClass:"language-sass extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sass"}},[s("code",[s("span",{pre:!0,attrs:{class:"token atrule-line"}},[s("span",{pre:!0,attrs:{class:"token atrule"}},[t._v("@charset")]),t._v(' "utf-8";')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token atrule-line"}},[s("span",{pre:!0,attrs:{class:"token atrule"}},[t._v("@import")]),t._v(' "~bulma/sass/utilities/_all.sass"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token atrule-line"}},[s("span",{pre:!0,attrs:{class:"token atrule"}},[t._v("@import")]),t._v(' "~bulma/sass/base/_all.sass"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token atrule-line"}},[s("span",{pre:!0,attrs:{class:"token atrule"}},[t._v("@import")]),t._v(' "~bulma/sass/components/card.sass"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token atrule-line"}},[s("span",{pre:!0,attrs:{class:"token atrule"}},[t._v("@import")]),t._v(' "~bulma/sass/elements/title.sass"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token atrule-line"}},[s("span",{pre:!0,attrs:{class:"token atrule"}},[t._v("@import")]),t._v(' "~bulma/sass/grid/columns.sass"')]),t._v("\n")])])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("details",[s("summary",[t._v("Solution")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" _capitalize "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"lodash/capitalize"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("We only cut the trees we don't grew directly, this was our dependencies.\nLet's focus on app code, if you look at "),e("code",[this._v("pokemon.service.js")]),this._v(" you will see that a method is not use in our application.\nWebpack can detect it and removes it from the bundle.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"warning custom-block"},[e("p",{staticClass:"custom-block-title"},[this._v("WARNING")]),this._v(" "),e("p",[this._v("Webpack is not automagically tree shaking dead code. ðŸ˜­")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("blockquote",[e("p",[this._v('"ok my code is safe, it does not contain modules creating side effects on the app you could try to optimize it" - You')])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Just try to add "),e("code",[this._v('"sideEffects": false')]),this._v(" in your package.json file.\nWebpack will load this configuration and will optimize bundles to eliminate dead code.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Let's try with "),e("code",[this._v('"sideEffects": ["*.sass"]')]),this._v(" ðŸŽ‰!")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"code-splitting"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#code-splitting","aria-hidden":"true"}},[this._v("#")]),this._v(" Code splitting")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("We could do that by adding another entry in Webpack configuration "),e("strong",[this._v("OR")]),this._v(" we could use webpack dynamic imports.")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("details",[s("summary",[t._v("Solution")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Vue "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"vue"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Router "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"vue-router"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nVue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Router"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Router")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  routes"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" component"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./pages/home"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/details/:id"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      component"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./pages/details"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      props"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"name-your-chunks"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#name-your-chunks","aria-hidden":"true"}},[this._v("#")]),this._v(" Name your chunks !")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Ok the two "),e("code",[this._v("chunk")]),this._v(" contains your page code and that's great.\nYou could try to load your app, the browser will only load the JS you need to display the page.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ol",[e("li",[this._v("Change the output filename config to "),e("code",[this._v("[name].bundle.js")])]),this._v(" "),e("li",[this._v("Add a comment in the dynamic import to name your chunk ("),e("code",[this._v('import(/* webpackChunkName: "home" */ "./pages/home")')]),this._v(")")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"prefetch-your-bundles"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#prefetch-your-bundles","aria-hidden":"true"}},[this._v("#")]),this._v(" Prefetch your bundles !")])}],!1,null,null,null);n.options.__file="reduce-bundle-size.md";e.default=n.exports}}]);